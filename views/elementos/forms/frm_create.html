<form class="form-horizontal">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title"><strong>Elemento de Configuración</strong>/ Item Configuration (IC) - Nuevo</h3>
        </div>
        <div class="panel-body">
            <p>Información general del nuevo elemento de configuración.</p>
        </div>
        <div class="panel-body">

            <div class="row">
                <!-- col1 -->
                <div class="col-md-4">

                    <div class="form-group">
                        <label class="col-md-3 control-label">Nombre</label>
                        <div class="col-md-9">
                            <input type="text" placeholder="ej. Servidor 1" class="form-control" ng-minlength=3 name="nombre" ng-model="elemento.nombre" ng-required="true" />
                            <!--  -->
                            <div class="error" ng-show="elemento_frm.nombre.$invalid && !elemento_frm.nombre.$pristine">
                                <small class="error" ng-show="elemento_frm.nombre.$error.required">
                                    No puedes dejar este campo en blanco.
                                </small>
                                <small class="error" ng-show="elemento_frm.nombre.$error.minlength">
                                    El nombre debe tener al menos 3 letras.
                                </small>
                            </div>
                            <!--  -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-3 control-label">Empresa</label>
                        <div class="col-md-9">
                            <select class="form-control select" name="empresa" ng-model="elemento.empresa" ng-required="true" ng-options="empresa.razon_social for empresa in empresas"  >
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label">Sucursal</label>
                        <div class="col-md-9">
                            <select class="form-control select" name="sucursal" ng-model="elemento.sucursal" ng-required="true" ng-options="sucursal.nombre for sucursal in sucursales"  >
                            </select>
                            <!--  -->
                            <div class="error" ng-show="elemento_frm.sucursal.$invalid && elemento_frm.sucursal.$pristine">
                                <small class="error" ng-show="elemento_frm.sucursal.$error.required">
                                    Es necesario seleccionar un elemento.
                                </small>
                            </div>
                            <!--  -->
                        </div>
                    </div>

                    <div class="form-group" style="display: none;">
                        <label class="col-md-3 control-label">Proveedor</label>
                        <div class="col-md-9">
                            <div class="input-group">
                                <input type="text" class="form-control" ng-model="elemento.proveedor.id" readonly="" />
                                <span class="input-group-btn" ><button type="button" class="btn btn-default" ng-click="open('lg')"><span class="fa fa-search"></span></button></span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-3 control-label">Criticidad</label>
                        <div class="col-md-9">
                            <select class="form-control select" name="criticidad" ng-model="elemento.criticidad" ng-required="true" ng-options="criticidad.nombre for criticidad in impactos"  >
                            </select>
                            <span class="help-block">Criticidad para el negocio</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-3 control-label">Estado</label>
                        <div class="col-md-9">
                            <select class="form-control select" name="estado" ng-model="elemento.estado" ng-required="true" ng-options="estado.nombre for estado in estados"  >
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-3 control-label">Clase</label>
                        <div class="col-md-9">
                            <select class="form-control select" name="clase" ng-model="elemento.clase" ng-options="clase.nombre for clase in clases" ></select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-3 control-label">Clasificación</label>
                        <div class="col-md-9">
                            <select class="form-control select" name="clasificacionhw" ng-model="elemento.clasificacion" ng-required="true" ng-options="clasificacion.nombre for clasificacion in clasificaciones track by clasificacion.id" ></select>
                        </div>
                    </div>

                </div>
                <!-- end - col1 -->

                <!-- hardware information -->
                <div clas="col-md-8" ng-show="elemento.clase.id == 1">

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-md-3 control-label">Marca</label>
                            <div class="col-md-9">
                                <select class="form-control select" name="marca" ng-model="elemento.hardware.marca" ng-required="elemento.clase.id == 1" ng-options="marca.nombre for marca in marcas"  >
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">Modelo</label>
                            <div class="col-md-9">
                                <input type="text" placeholder="ej. Series 7 Chronos" class="form-control" ng-minlength=3 name="modelo" ng-model="elemento.hardware.modelo" />
                                <!--  -->
                                <div class="error" ng-show="elemento_frm.modelo.$invalid && !elemento_frm.modelo.$pristine">
                                    <small class="error" ng-show="elemento_frm.modelo.$error.minlength">
                                        El modelo  debe tener al menos 3 letras.
                                    </small>
                                </div>
                                <!--  -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">Nro. Serie</label>
                            <div class="col-md-9">
                                <input type="text" placeholder="ej. W80466XXDAS" class="form-control" name="nroserie" ng-model="elemento.hardware.nroserie" ng-minlength=3 />
                                <!--  -->
                                <div class="error" ng-show="elemento_frm.nroserie.$invalid && !elemento_frm.nroserie.$pristine">
                                    <small class="error" ng-show="elemento_frm.nroserie.$error.minlength">
                                        El Nro de serie debe tener al menos 3 letras.
                                    </small>
                                </div>
                                <!--  -->
                            </div>
                        </div>

                        <div ng-include="includeHw"></div>
                    </div>

                    <div class="col-md-4">

                        <div class="form-group" ng-controller="DatepickerCtrl">
                            <label class="col-md-3 control-label">F. Producción</label>
                            <div class="col-md-9">
                                <div class="input-group">
                                    <input type="text" disabled class="form-control" ng-model="elemento.hardware.mover_produccion" datepicker-popup="yyyy-MM-dd" is-open="opened" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="cerrar" />
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open($event)"><i class="fa fa-calendar"></i></button>
                                    </span>
                                </div>
                                <span class="help-block">Puesto en producción</span>
                            </div>
                        </div>

                        <div class="form-group" ng-controller="DatepickerCtrl">
                            <label class="col-md-3 control-label">F. Compra</label>
                            <div class="col-md-9">
                                <div class="input-group">
                                    <input type="text" disabled class="form-control" ng-model="elemento.hardware.fecha_compra" datepicker-popup="yyyy-MM-dd" is-open="opened" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="cerrar" />
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open($event)"><i class="fa fa-calendar"></i></button>
                                    </span>
                                </div>
                                <span class="help-block">Indica la fecha de compra</span>
                            </div>
                        </div>

                        <div class="form-group" ng-controller="DatepickerCtrl">
                            <label class="col-md-3 control-label">F. Garantía</label>
                            <div class="col-md-9">
                                <div class="input-group">
                                    <input type="text" disabled class="form-control" ng-model="elemento.hardware.fin_garantia" datepicker-popup="yyyy-MM-dd" is-open="opened" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="cerrar" />
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open($event)"><i class="fa fa-calendar"></i></button>
                                    </span>
                                </div>
                                <span class="help-block">Indica la fecha de vencimiento de la garantía</span>
                            </div>
                        </div>

                         <div class="form-group">
                            <label class="col-md-3 control-label">Descripción</label>
                            <div class="col-md-9 col-xs-12">
                                <textarea class="form-control" placeholder="ej. Requisitos del sistema e instalación" rows="5" name="descripcion" ng-required="elemento.clase.id == 1" ng-minlength=10 ng-model="elemento.hardware.descripcion"></textarea>
                                <!--  -->
                                <div class="error" ng-show="elemento_frm.descripcion.$invalid && !elemento_frm.descripcion.$pristine">
                                    <small class="error" ng-show="elemento_frm.descripcion.$error.required">
                                        No puedes dejar vacio este campo.
                                    </small>
                                    <small class="error" ng-show="elemento_frm.descripcion.$error.minlength">
                                        La descripción debe tener al menos 10 letras.
                                    </small>
                                </div>
                                <!--  -->
                                <span class="help-block">Detalla alguna información adicional</span>
                            </div>
                        </div>
                    </div>
                    <!-- end-col3 -->
                </div>
                <!-- end-hardware information -->


                <!-- software information -->
                <div clas="col-md-8" ng-show="elemento.clase.id == 2">

                    <div class="col-md-4">

                        <div class="form-group">
                            <label class="col-md-3 control-label">Familia</label>
                            <div class="col-md-9 col-xs-12">
                                <select class="form-control select" name="familia" ng-model="elemento.software.familia" ng-required="elemento.clase.id == 2" ng-options="familia.nombre for familia in familias" ></select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">Plataforma</label>
                            <div class="col-md-9 col-xs-12">
                                <select class="form-control select" name="arquitectura" ng-model="elemento.software.arquitectura" ng-required="elemento.clase.id == 2" ng-options="arquitectura.nombre for arquitectura in arquitecturas" ></select>
                            </div>
                        </div>


                        <div class="form-group">
                            <label class="col-md-3 control-label">Versión</label>
                            <div class="col-md-9">
                                <input type="text" placeholder="ej. 2.0" class="form-control" name="version" ng-model="elemento.software.version" ng-required="elemento.clase.id == 2" />
                                <!--  -->
                                <div class="error" ng-show="elemento_frm.version.$invalid && !elemento_frm.version.$pristine">
                                    <small class="error" ng-show="elemento_frm.version.$error.required">
                                        No puedes dejar vacio este campo.
                                    </small>
                                    <small class="error" ng-show="elemento_frm.version.$error.minlength">
                                            Versión debe tener al menos 1 digito.
                                    </small>
                                </div>
                                <!--  -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">URL</label>
                            <div class="col-md-9">
                                <input type="url" placeholder="ej. http://www.hostname.com" class="form-control" ng-minlength=5 name="url" ng-model="elemento.software.url" />
                                <!--  -->
                                <div class="error" ng-show="elemento_frm.url.$invalid && !elemento_frm.url.$pristine">
                                    <small class="error" ng-show="elemento_frm.url.$error.required">
                                        No puedes dejar vacio este campo.
                                    </small>
                                    <small class="error" ng-show="elemento_frm.url.$error.minlength">
                                        La direccion URL debe tener al menos 5 letras.
                                    </small>
                                </div>
                                <!--  -->
                            </div>
                        </div>

                         <div class="form-group">
                            <label class="col-md-3 control-label">Ruta</label>
                            <div class="col-md-9">
                                <input type="text" placeholder="ej. /usr/bin/" class="form-control" ng-minlength=5 name="ruta" ng-model="elemento.software.ruta" />
                                <!--  -->
                                <div class="error" ng-show="elemento_frm.ruta.$invalid && !elemento_frm.ruta.$pristine">
                                    <small class="error" ng-show="elemento_frm.ruta.$error.required">
                                        No puedes dejar vacio este campo.
                                    </small>
                                    <small class="error" ng-show="elemento_frm.ruta.$error.minlength">
                                            La ruta debe tener al menos 5 letras.
                                    </small>
                                </div>
                                <!--  -->
                                <span class="help-block">Indica la ruta de instalacion</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">Licencia</label>
                            <div class="col-md-9">
                                <input type="text" class="form-control" ng-minlength=5 name="serial_number" ng-model="elemento.software.serial_number" />
                                <!--  -->
                                <div class="error" ng-show="elemento_frm.serial_number.$invalid && !elemento_frm.serial_number.$pristine">
                                    <small class="error" ng-show="elemento_frm.serial_number.$error.required">
                                        No puedes dejar vacio este campo.
                                    </small>
                                    <small class="error" ng-show="elemento_frm.serial_number.$error.minlength">
                                            Serial number debe tener al menos 5 letras.
                                    </small>
                                </div>
                                <!--  -->
                            </div>
                        </div>

                        <div ng-include="includeSw"></div>

                    </div>

                    <div class="col-md-4">
                        <div class="form-group" ng-controller="DatepickerCtrl">
                            <label class="col-md-3 control-label">F. Despliegue</label>
                            <div class="col-md-9">
                                <div class="input-group">
                                    <input type="text" disabled class="form-control" ng-model="elemento.software.fecha_despliegue" datepicker-popup="yyyy-MM-dd" is-open="opened" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="cerrar" />
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open($event)"><i class="fa fa-calendar"></i></button>
                                    </span>
                                </div>
                                <span class="help-block">Indica la fecha de despliegue</span>
                            </div>
                        </div>

                        <div class="form-group" ng-controller="DatepickerCtrl">
                            <label class="col-md-3 control-label">F. Soporte</label>
                            <div class="col-md-9">
                                <div class="input-group">
                                    <input type="text" disabled class="form-control" ng-model="elemento.software.fin_soporte" datepicker-popup="yyyy-MM-dd" is-open="opened" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="cerrar" />
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open($event)"><i class="fa fa-calendar"></i></button>
                                    </span>
                                </div>
                                <span class="help-block">Indica la fecha de vencimiento del soporte</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">Descripción</label>
                            <div class="col-md-9 col-xs-12">
                                <textarea class="form-control" rows="5" name="descripcion" ng-required="elemento.clase.id == 2" ng-minlength=10 ng-model="elemento.software.descripcion"></textarea>
                                <span class="help-block">Detalla alguna información importante. ej. requerimientos.</span>
                            </div>
                        </div>

                    </div>
                    <!-- end-col3 -->
                </div>
                <!-- end-software information -->

                <!-- sla information -->
                <div class="col-md-8" ng-show="elemento.clase.id == 3">

                </div>
                <!-- end-sla information -->
            </div>

        </div>

    </div>


    <tabset class="panel tabs">
        <tab heading="Elementos">
            <div class="panel-body">

                <div class="row">
                    <div class="col-md-12">

                        <div class="form-group">
                            <h4>Lista de Elementos</h4>
                            <div class="col-md-3 col-xs-12">
                                <label class="check"><input type="checkbox" class="icheckbox_minimal-grey checked icheckbox" name="updategrupos" ng-model="elemento.showelementoshw" checked="checked"/> Mostrar</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12" ng-show="elemento.showelementoshw">
                        <div class="table-responsive" ng-controller="dtComponentesWithActions" >
                            <div>
                                <table datatable dt-options="dtOptions" dt-columns="dtColumns" class="table table-hover datatable dataTable no-footer"></table>
                            </div>
                        </div>
                    </div>

                </div>

                <hr>

                <div class="row">
                    <div class="col-md-12">
                        <h4>Elementos Asociados</h4>
                        <table datatable="ng" dt-options="dtOptions" dt-column-defs="dtColumnDefs" class="table table-hover datatable dataTable no-footer">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Elemento</th>
                                    <th>Clasificación</th>
                                    <th>Estado</th>
                                    <th>Criticidad</th>
                                    <th>Empresa</th>
                                    <th>Sucursal</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                 <tr ng-repeat="item in elemento.parents">
                                    <td>{{ item.id }}</td>
                                    <td>{{ item.nombre }}</td>
                                    <td>{{ item.clasificacion.nombre }}</td>
                                    <td>{{ item.estado.nombre }}</td>
                                    <td>{{ item.criticidad.nombre }}</td>
                                    <td>{{ item.empresa.razon_social }}</td>
                                    <td>{{ item.sucursal.nombre }}</td>
                                    <td>
                                        <button type="button" class="btn btn-danger btn-sm" ng-click="removeItemHw($index)">
                                            <span class="glyphicon glyphicon-trash"></span> Quitar
                                        </button>
                                    </td>
                                 </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </tab>
    </tabset>

    <div class="panel-footer">
        <a href="#/elementos" class="btn btn-default">Regresar</a>
        <button type="submit" ng-click="newElemento(elemento_frm.$valid)" ng-disabled="elemento_frm.$invalid || elementoObs.uploader.isLoading" class="btn btn-primary pull-right">Guardar Elemento <span class="fa fa-floppy-o fa-right"></span></button>
    </div>

</form>
